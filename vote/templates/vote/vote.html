{% if data.session.expires_at < now %}
    <!-- Ø§Ù„ØªØµÙˆÙŠØª Ù…Ù†ØªÙ‡ÙŠ -->
    <div class="vote-closed-alert">
        â° Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø§Ù„ØªØµÙˆÙŠØª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù„Ø³Ø©. Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØµÙˆÙŠØªØŒ ÙˆÙ„ÙƒÙ† ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø£Ø¯Ù†Ø§Ù‡.
    </div>
    <h4 style="margin-top: 10px;">ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</h4>
    <ul style="list-style: none; padding: 0;">
        {% for result in data.results %}
            <li style="font-size: 13px;">ğŸ“Œ {{ result.option__text }} - {{ result.count }} ØµÙˆØª ({{ result.percent }}%)</li>
        {% endfor %}
    </ul>
    <p style="font-size: 12px; color: #ccc; margin-top: 8px;">ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµÙˆØªÙŠÙ†: {{ data.total_votes }}</p>

{% elif data.session.start_at > now %}
    <!-- Ø§Ù„ØªØµÙˆÙŠØª Ù„Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ø¹Ø¯ -->
    <div class="vote-not-started-alert" style="background: #fff3cd; padding: 12px; border: 1px solid #ffeeba; border-radius: 8px; color: #856404;">
        â³ Ø§Ù„ØªØµÙˆÙŠØª Ù„Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ø¹Ø¯. ÙŠØ¨Ø¯Ø£ ÙÙŠ: {{ data.session.start_at|date:"Y-m-d H:i" }}
        <br>
        â±ï¸ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ: <span id="countdown-{{ forloop.counter }}"></span>
    </div>
    <script>
        const countdownEl{{ forloop.counter }} = document.getElementById("countdown-{{ forloop.counter }}");
        const targetTime{{ forloop.counter }} = new Date("{{ data.session.start_at|date:'Y-m-d H:i:s' }}").getTime();

        const timer{{ forloop.counter }} = setInterval(function() {
            const now = new Date().getTime();
            const distance = targetTime{{ forloop.counter }} - now;

            if (distance <= 0) {
                clearInterval(timer{{ forloop.counter }});
                countdownEl{{ forloop.counter }}.innerHTML = "Ø¨Ø¯Ø£ Ø§Ù„ØªØµÙˆÙŠØª!";
                location.reload(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
            } else {
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                countdownEl{{ forloop.counter }}.innerHTML = hours + "Ø³ " + minutes + "Ø¯ " + seconds + "Ø« ";
            }
        }, 1000);
    </script>

{% elif data.already_voted %}
    <!-- ØªÙ… Ø§Ù„ØªØµÙˆÙŠØª Ù…Ø³Ø¨Ù‚Ù‹Ø§ -->
    <p style="color: #4caf50; font-weight: bold;">âœ… ØªÙ… Ø§Ù„ØªØµÙˆÙŠØª</p>
    <h4 style="margin-top: 10px;">ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</h4>
    <ul style="list-style: none; padding: 0;">
        {% for result in data.results %}
            <li style="font-size: 13px;">ğŸ“Œ {{ result.option__text }} - {{ result.count }} ØµÙˆØª ({{ result.percent }}%)</li>
        {% endfor %}
    </ul>
    <p style="font-size: 12px; color: #ccc; margin-top: 8px;">ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµÙˆØªÙŠÙ†: {{ data.total_votes }}</p>

{% elif can_vote == "Ù„Ø§" %}
    <!-- ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ù„Ù‡ Ø¨Ø§Ù„ØªØµÙˆÙŠØª -->
    <h4 style="margin-top: 10px;">ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</h4>
    <ul style="list-style: none; padding: 0;">
        {% for result in data.results %}
            <li style="font-size: 13px;">ğŸ“Œ {{ result.option__text }} - {{ result.count }} ØµÙˆØª ({{ result.percent }}%)</li>
        {% endfor %}
    </ul>
    <p style="font-size: 12px; color: #ccc; margin-top: 8px;">ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµÙˆØªÙŠÙ†: {{ data.total_votes }}</p>

{% else %}
    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØµÙˆÙŠØª -->
    <form method="post" class="vote-form" style="margin-top: 10px;">
        {% csrf_token %}
        <input type="hidden" name="session_id" value="{{ data.session.id }}">
        <ul style="list-style: none; padding: 0; margin: 10px 0;">
            {% for option in data.options %}
                <li style="margin-bottom: 10px;">
                    <label style="display: grid; grid-template-columns: auto 1fr; align-items: center; gap: 10px; direction: rtl; font-size: 15px;">
                        <input type="radio" name="option" value="{{ option.id }}" required style="transform: scale(1.3);">
                        <span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{ option.text }}</span>
                    </label>
                </li>
            {% endfor %}
        </ul>
        <button type="submit" class="vote-btn" style="
            background: #e53935;
            border: none;
            padding: 10px 20px;
            color: white;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        " onmouseover="this.style.background='#c62828'" onmouseout="this.style.background='#e53935'">
            ØªØµÙˆÙŠØª
        </button>
    </form>
{% endif %}
